<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lider FLOW - Proyecto FLOW</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #1a2035;
            --accent-blue: #0d6efd;
            --bg-light: #f3f4f7;
            --card-white: #ffffff;
            --text-grey: #6c757d;
            --border-radius: 8px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-light);
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Estilos específicos que tenías definidos */
        .files-sidebar {
            width: 350px;
            background: var(--card-white);
            border-radius: var(--border-radius);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 15px;
            border-bottom: 1px solid #eee;
            font-weight: bold;
            color: var(--primary-blue);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .pdf-card {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid #eee;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }

        .pdf-card:hover {
            border-color: var(--accent-blue);
            transform: translateX(2px);
            box-shadow: 0 2px 8px rgba(13, 110, 253, 0.1);
        }

        .pdf-card.active {
            background-color: #e7f1ff;
            border-color: var(--accent-blue);
        }

        .pdf-icon {
            font-size: 24px;
            color: #dc3545;
        }

        .pdf-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .pdf-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--primary-blue);
            margin-bottom: 2px;
        }

        .pdf-date {
            font-size: 0.75rem;
            color: var(--text-grey);
        }

        .viewer-container {
            flex: 1;
            background: var(--card-white);
            border-radius: var(--border-radius);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .viewer-header {
            padding: 10px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #ccc;
        }

        .empty-state i { font-size: 4rem; margin-bottom: 1rem; }
        
        .btn-action {
            background-color: var(--accent-blue);
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            text-decoration: none;
        }
        
        .btn-action:hover { background-color: #0b5ed7; }

        .nav-btn.active { background-color: #2563eb; color: white; border-color: #2563eb; }

        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            padding: 20px;
            gap: 20px;
        }
    </style>
</head>
<body class="bg-slate-50">

    <nav class="bg-slate-900 text-white p-4 shadow-xl sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="p-2 rounded-lg">
                    <img src="https://www.s-lecfilm.com/wp-content/themes/s-lecfilm/images/footer-logo.png" alt="FLOW Logo" style="width: 128px;">
                </div>
                <div>
                    <h1 class="text-xl font-bold tracking-wide">FLOW WMS <span class="text-blue-400">Tracker</span></h1>
                    <p class="text-xs text-slate-400">Gestión de Prioridades Críticas</p>
                </div>
            </div>
            
            <div class="hidden md:flex bg-slate-800 rounded-lg p-1 gap-1">
                <button onclick="switchTab('dashboard')" id="btn-dashboard" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-300 hover:text-white">
                    <i class="fa-solid fa-chart-pie mr-2"></i> Dashboard
                </button>
                <button onclick="switchTab('schedule')" id="btn-schedule" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-300 hover:text-white">
                    <i class="fa-solid fa-calendar-days mr-2"></i> Cronograma
                </button>
                <button onclick="switchTab('reportes')" id="btn-reportes" class="nav-btn px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-300 hover:text-white active">
                    <i class="fa-solid fa-file-pdf mr-2"></i> Reportes
                </button>
            </div>

            <div class="text-right hidden lg:block">
                <div class="flex items-center gap-2">
                    <div class="text-right">
                        <p class="text-xs text-slate-400">Hoy es</p>
                        <p class="text-xs font-bold text-white" id="currentDateHeader">...</p>
                    </div>
                    <i class="fa-regular fa-calendar text-slate-500"></i>
                </div>
            </div>
        </div>
    </nav>
    
    <div class="md:hidden bg-white border-b p-2 flex justify-center gap-2 sticky top-[72px] z-40">
        <button onclick="switchTab('dashboard')" class="flex-1 py-2 px-4 rounded border text-sm font-bold text-slate-600">Dashboard</button>
        <button onclick="switchTab('schedule')" class="flex-1 py-2 px-4 rounded border text-sm font-bold text-slate-600">Cronograma</button>
        <button onclick="switchTab('reportes')" class="flex-1 py-2 px-4 rounded border text-sm font-bold bg-blue-50 text-blue-600 border-blue-200">Reportes</button>
    </div>

    <div class="main-container">
        <aside class="files-sidebar">
            <div class="sidebar-header">
                <span><i class="fas fa-folder-open"></i> Archivos Disponibles</span>
                <span class="badge" style="background:#e9ecef; color:#333; padding:2px 6px; border-radius:4px; font-size:0.8rem;" id="fileCount">0</span>
            </div>
            <div class="file-list" id="fileListContainer">
                </div>
        </aside>

        <main class="viewer-container">
            <div class="viewer-header">
                <strong id="viewerTitle">Selecciona un archivo</strong>
                <a href="#" id="downloadBtn" class="btn-action" style="display:none;" download>
                    <i class="fas fa-download"></i> Descargar
                </a>
            </div>
            <div id="pdfWrapper" style="height: 100%;">
                <div class="empty-state">
                    <i class="fas fa-file-pdf"></i>
                    <p>Selecciona un reporte de la lista para visualizarlo</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Actualizar fecha actual en el header
        const hoy = new Date();
        const opciones = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const fechaFormato = hoy.toLocaleDateString('es-ES', opciones);
        const fechaCapitalizada = fechaFormato.charAt(0).toUpperCase() + fechaFormato.slice(1);
        document.getElementById('currentDateHeader').innerText = fechaCapitalizada;

        // --- LÓGICA PARA GITHUB PAGES (FETCH JSON) ---
        async function initGallery() {
            const container = document.getElementById('fileListContainer');
            const viewerWrapper = document.getElementById('pdfWrapper');
            const viewerTitle = document.getElementById('viewerTitle');
            const countLabel = document.getElementById('fileCount');
            const downloadBtn = document.getElementById('downloadBtn');

            try {
                // 1. PETICIÓN AL JSON: Aquí es donde GitHub leerá tu archivo lista_pdfs.json
                const response = await fetch('lista_pdfs.json');
                
                if (!response.ok) {
                    throw new Error("No se encontró el archivo lista_pdfs.json");
                }
                
                // Convertimos la respuesta a un arreglo de JS
                const pdfFiles = await response.json();

                // 2. PROCESAMIENTO (Igual que antes)
                const processedFiles = pdfFiles.map(filename => {
                    const parts = filename.split('_');
                    const datePart = parts[0]; 
                    const namePart = parts.slice(1).join(' ').replace('.pdf', '').replace(/-/g, ' ');
                    
                    return {
                        original: filename,
                        dateObj: new Date(datePart),
                        dateDisplay: datePart,
                        displayName: namePart
                    };
                }).sort((a, b) => b.dateObj - a.dateObj);

                countLabel.innerText = processedFiles.length;

                // 3. GENERACIÓN DE ELEMENTOS
                processedFiles.forEach((file) => {
                    const card = document.createElement('div');
                    card.className = 'pdf-card';
                    card.innerHTML = `
                        <div class="pdf-icon"><i class="fas fa-file-pdf"></i></div>
                        <div class="pdf-info">
                            <span class="pdf-name">${file.displayName}</span>
                            <span class="pdf-date"><i class="far fa-clock"></i> ${file.dateDisplay}</span>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#ccc; font-size:0.8rem;"></i>
                    `;

                    card.addEventListener('click', () => {
                        document.querySelectorAll('.pdf-card').forEach(c => c.classList.remove('active'));
                        card.classList.add('active');

                        const pdfPath = `pdf/${file.original}`;
                        viewerWrapper.innerHTML = `<iframe src="${pdfPath}#toolbar=0&navpanes=0&scrollbar=0" type="application/pdf"></iframe>`;
                        
                        viewerTitle.innerText = file.displayName;
                        downloadBtn.style.display = 'inline-block';
                        downloadBtn.href = pdfPath;
                    });

                    container.appendChild(card);
                });

            } catch (error) {
                console.error("Error cargando la lista:", error);
                container.innerHTML = `
                    <div style="padding:20px; text-align:center; color:#dc3545;">
                        <i class="fas fa-exclamation-circle fa-2x"></i>
                        <p>Error cargando archivos.</p>
                        <small>Asegúrate de haber subido 'lista_pdfs.json' a GitHub.</small>
                    </div>
                `;
            }
        }

        // Iniciar la galería asíncrona
        initGallery();

        // Navegación
        window.switchTab = function(tab) {
            if(tab === 'dashboard') {
                window.location.href = 'index.html';
            } else if(tab === 'schedule') {
                window.location.href = 'index.html'; // Ajusta esto si tienes otra página
            }
        }
    </script>
</body>
</html>
